<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cwl.qzzp.dao.EnterpriseinfoDao">
    <resultMap id="BaseResultMap" type="com.cwl.qzzp.dto.EnterpriseinfoDTO">
        <id column="eId" jdbcType="CHAR" property="eid"/>
        <result column="logoImage" jdbcType="VARCHAR" property="logoimage"/>
        <result column="eName" jdbcType="VARCHAR" property="ename"/>
        <result column="ePlace" jdbcType="VARCHAR" property="eplace"/>
        <result column="signLanguage" jdbcType="VARCHAR" property="signlanguage"/>
        <result column="eIntroducation" jdbcType="VARCHAR" property="eintroducation"/>
        <result column="financingStage" jdbcType="VARCHAR" property="financingstage"/>
        <result column="category" jdbcType="VARCHAR" property="category"/>
        <result column="eUrl" jdbcType="VARCHAR" property="eurl"/>
        <result column="eImage1" jdbcType="VARCHAR" property="eimage1"/>
        <result column="eImage2" jdbcType="VARCHAR" property="eimage2"/>
        <result column="eImage3" jdbcType="VARCHAR" property="eimage3"/>
        <result column="evaluationNum" jdbcType="INTEGER" property="evaluationnum"/>
        <result column="positionNum" jdbcType="INTEGER" property="positionnum"/>
        <result column="dealRate" jdbcType="DOUBLE" property="dealrate"/>
        <result column="benefit1" jdbcType="VARCHAR" property="benefit1"/>
        <result column="benefit2" jdbcType="VARCHAR" property="benefit2"/>
        <result column="benefit3" jdbcType="VARCHAR" property="benefit3"/>
        <result column="benefit4" jdbcType="VARCHAR" property="benefit4"/>
        <result column="benefit5" jdbcType="VARCHAR" property="benefit5"/>
        <result column="visitNum" jdbcType="INTEGER" property="visitnum"/>
        <result column="numberOfWorkers" jdbcType="INTEGER" property="numberofworkers"/>
    </resultMap>

    <resultMap id="BaseResultMap2" type="com.cwl.qzzp.dto.EnterpriseinfoDTO">
        <id column="eId" jdbcType="CHAR" property="eid"/>
        <result column="logoImage" jdbcType="VARCHAR" property="logoimage"/>
        <result column="eName" jdbcType="VARCHAR" property="ename"/>
        <result column="ePlace" jdbcType="VARCHAR" property="eplace"/>
        <result column="signLanguage" jdbcType="VARCHAR" property="signlanguage"/>
        <result column="eIntroducation" jdbcType="VARCHAR" property="eintroducation"/>
        <result column="financingStage" jdbcType="VARCHAR" property="financingstage"/>
        <result column="category" jdbcType="VARCHAR" property="category"/>
        <result column="eUrl" jdbcType="VARCHAR" property="eurl"/>
        <result column="eImage1" jdbcType="VARCHAR" property="eimage1"/>
        <result column="eImage2" jdbcType="VARCHAR" property="eimage2"/>
        <result column="eImage3" jdbcType="VARCHAR" property="eimage3"/>
        <result column="evaluationNum" jdbcType="INTEGER" property="evaluationnum"/>
        <result column="positionNum" jdbcType="INTEGER" property="positionnum"/>
        <result column="dealRate" jdbcType="DOUBLE" property="dealrate"/>
        <result column="benefit1" jdbcType="VARCHAR" property="benefit1"/>
        <result column="benefit2" jdbcType="VARCHAR" property="benefit2"/>
        <result column="benefit3" jdbcType="VARCHAR" property="benefit3"/>
        <result column="benefit4" jdbcType="VARCHAR" property="benefit4"/>
        <result column="benefit5" jdbcType="VARCHAR" property="benefit5"/>
        <result column="visitNum" jdbcType="INTEGER" property="visitnum"/>
        <result column="numberOfWorkers" jdbcType="INTEGER" property="numberofworkers"/>
        <association property="managementTeamDTO" javaType="com.cwl.qzzp.dto.ManagementteamDTO">
            <id column="mIds" jdbcType="CHAR" property="mids"/>
            <result column="dataId" jdbcType="CHAR" property="dataid"/>
            <result column="mName" jdbcType="VARCHAR" property="mname"/>
            <result column="mIntroducation" jdbcType="VARCHAR" property="mintroducation"/>
            <result column="pMintroducation" jdbcType="VARCHAR" property="pmintroducation"/>
        </association>
        <collection property="positioninfoDTOList" ofType="com.cwl.qzzp.dto.PositioninfoDTO"
                    resultMap="com.cwl.qzzp.dao.PositioninfoDao.BaseResultMap" column="dataId">
        </collection>
    </resultMap>
    <sql id="Base_Column_List">
        eId, logoImage, eName, ePlace, signLanguage, eIntroducation, financingStage, category,
    eUrl, eImage1, eImage2, eImage3, evaluationNum, positionNum, dealRate, benefit1, 
    benefit2, benefit3, benefit4, benefit5, visitNum, numberOfWorkers
    </sql>
    <sql id="Base_Column_List2">
        eId, logoImage, eName, ePlace, signLanguage, eIntroducation, financingStage, category,
    eUrl, eImage1, eImage2, eImage3, evaluationNum, benefit1,
    benefit2, benefit3, benefit4, benefit5, numberOfWorkers
    </sql>
    <select id="selectByPrimaryKey" parameterType="java.lang.String" resultMap="BaseResultMap2">
        select e.*,
               m.*
                ,
               (select count(p2.pId) from positioninfo p2 where p2.dataId = e.eId) as positionNum,
               p.pId,
               p.pTitle,
               p.experience,
               p.salary,
               p.education,
               p.releaseTime,
               p.departments
        from enterpriseinfo e
                 left join positioninfo p on p.dataId = e.eId and p.states = '发布'
                 left join managementteam m on m.dataId = e.eId
        where eId = #{eid,jdbcType=CHAR}
    </select>
    <delete id="deleteByPrimaryKey" parameterType="java.lang.String">
        delete
        from enterpriseinfo
        where eId = #{eid,jdbcType=CHAR}
    </delete>
    <insert id="insert" keyColumn="eId" keyProperty="eid" parameterType="com.cwl.qzzp.dto.EnterpriseinfoDTO"
            useGeneratedKeys="true">
        insert into enterpriseinfo (logoImage, eName, ePlace,
                                    signLanguage, eIntroducation, financingStage,
                                    category, eUrl, eImage1,
                                    eImage2, eImage3, evaluationNum,
                                    positionNum, dealRate, benefit1,
                                    benefit2, benefit3, benefit4,
                                    benefit5, visitNum, numberOfWorkers)
        values (#{logoimage,jdbcType=VARCHAR}, #{ename,jdbcType=VARCHAR}, #{eplace,jdbcType=VARCHAR},
                #{signlanguage,jdbcType=VARCHAR}, #{eintroducation,jdbcType=VARCHAR},
                #{financingstage,jdbcType=VARCHAR},
                #{category,jdbcType=VARCHAR}, #{eurl,jdbcType=VARCHAR}, #{eimage1,jdbcType=VARCHAR},
                #{eimage2,jdbcType=VARCHAR}, #{eimage3,jdbcType=VARCHAR}, #{evaluationnum,jdbcType=INTEGER},
                #{positionnum,jdbcType=INTEGER}, #{dealrate,jdbcType=DOUBLE}, #{benefit1,jdbcType=VARCHAR},
                #{benefit2,jdbcType=VARCHAR}, #{benefit3,jdbcType=VARCHAR}, #{benefit4,jdbcType=VARCHAR},
                #{benefit5,jdbcType=VARCHAR}, #{visitnum,jdbcType=INTEGER}, #{numberofworkers,jdbcType=VARCHAR})
    </insert>
    <insert id="insertSelective" keyColumn="eId" keyProperty="eid" parameterType="com.cwl.qzzp.dto.EnterpriseinfoDTO"
            useGeneratedKeys="true">
        insert into enterpriseinfo
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="eid != null">
                eId,
            </if>
            <if test="logoimage != null">
                logoImage,
            </if>
            <if test="ename != null">
                eName,
            </if>
            <if test="eplace != null">
                ePlace,
            </if>
            <if test="signlanguage != null">
                signLanguage,
            </if>
            <if test="eintroducation != null">
                eIntroducation,
            </if>
            <if test="financingstage != null">
                financingStage,
            </if>
            <if test="category != null">
                category,
            </if>
            <if test="eurl != null">
                eUrl,
            </if>
            <if test="eimage1 != null">
                eImage1,
            </if>
            <if test="eimage2 != null">
                eImage2,
            </if>
            <if test="eimage3 != null">
                eImage3,
            </if>
            evaluationNum,
            positionNum,
            dealRate,
            <if test="benefit1 != null">
                benefit1,
            </if>
            <if test="benefit2 != null">
                benefit2,
            </if>
            <if test="benefit3 != null">
                benefit3,
            </if>
            <if test="benefit4 != null">
                benefit4,
            </if>
            <if test="benefit5 != null">
                benefit5,
            </if>
            visitNum,
            <if test="numberofworkers != null">
                numberOfWorkers,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="eid != null">
                #{eid,jdbcType=VARCHAR},
            </if>
            <if test="logoimage != null">
                #{logoimage,jdbcType=VARCHAR},
            </if>
            <if test="ename != null">
                #{ename,jdbcType=VARCHAR},
            </if>
            <if test="eplace != null">
                #{eplace,jdbcType=VARCHAR},
            </if>
            <if test="signlanguage != null">
                #{signlanguage,jdbcType=VARCHAR},
            </if>
            <if test="eintroducation != null">
                #{eintroducation,jdbcType=VARCHAR},
            </if>
            <if test="financingstage != null">
                #{financingstage,jdbcType=VARCHAR},
            </if>
            <if test="category != null">
                #{category,jdbcType=VARCHAR},
            </if>
            <if test="eurl != null">
                #{eurl,jdbcType=VARCHAR},
            </if>
            <if test="eimage1 != null">
                #{eimage1,jdbcType=VARCHAR},
            </if>
            <if test="eimage2 != null">
                #{eimage2,jdbcType=VARCHAR},
            </if>
            <if test="eimage3 != null">
                #{eimage3,jdbcType=VARCHAR},
            </if>
            0,
            0,
            0.0,
            <if test="benefit1 != null">
                #{benefit1,jdbcType=VARCHAR},
            </if>
            <if test="benefit2 != null">
                #{benefit2,jdbcType=VARCHAR},
            </if>
            <if test="benefit3 != null">
                #{benefit3,jdbcType=VARCHAR},
            </if>
            <if test="benefit4 != null">
                #{benefit4,jdbcType=VARCHAR},
            </if>
            <if test="benefit5 != null">
                #{benefit5,jdbcType=VARCHAR},
            </if>
            1,
            <if test="numberofworkers != null">
                #{numberofworkers,jdbcType=VARCHAR},
            </if>
        </trim>
    </insert>
    <update id="updateByPrimaryKeySelective" parameterType="com.cwl.qzzp.dto.EnterpriseinfoDTO">
        update enterpriseinfo
        <set>
            <if test="logoimage != null">
                logoImage = #{logoimage,jdbcType=VARCHAR},
            </if>
            <if test="ename != null">
                eName = #{ename,jdbcType=VARCHAR},
            </if>
            <if test="eplace != null">
                ePlace = #{eplace,jdbcType=VARCHAR},
            </if>
            <if test="signlanguage != null">
                signLanguage = #{signlanguage,jdbcType=VARCHAR},
            </if>
            <if test="financingstage != null">
                financingStage = #{financingstage,jdbcType=VARCHAR},
            </if>
            <if test="category != null">
                category = #{category,jdbcType=VARCHAR},
            </if>
            <if test="eurl != null">
                eUrl = #{eurl,jdbcType=VARCHAR},
            </if>
            <if test="eimage1 != null">
                eImage1 = #{eimage1,jdbcType=VARCHAR},
            </if>
            <if test="eimage2 != null">
                eImage2 = #{eimage2,jdbcType=VARCHAR},
            </if>
            <if test="eimage3 != null">
                eImage3 = #{eimage3,jdbcType=VARCHAR},
            </if>
            <if test="evaluationnum != null">
                evaluationNum = #{evaluationnum,jdbcType=INTEGER},
            </if>
            <if test="positionnum != null">
                positionNum = #{positionnum,jdbcType=INTEGER},
            </if>
            <if test="dealrate != null">
                dealRate = #{dealrate,jdbcType=DOUBLE},
            </if>
            <if test="benefit1 != null">
                benefit1 = #{benefit1,jdbcType=VARCHAR},
            </if>
            <if test="benefit2 != null">
                benefit2 = #{benefit2,jdbcType=VARCHAR},
            </if>
            <if test="benefit3 != null">
                benefit3 = #{benefit3,jdbcType=VARCHAR},
            </if>
            <if test="benefit4 != null">
                benefit4 = #{benefit4,jdbcType=VARCHAR},
            </if>
            <if test="benefit5 != null">
                benefit5 = #{benefit5,jdbcType=VARCHAR},
            </if>
            <if test="visitnum != null">
                visitNum = #{visitnum,jdbcType=INTEGER},
            </if>
            <if test="numberofworkers != null">
                numberOfWorkers = #{numberofworkers,jdbcType=VARCHAR},
            </if>
        </set>
        where eId = #{eid,jdbcType=CHAR}
    </update>
    <update id="updateByPrimaryKey" parameterType="com.cwl.qzzp.dto.EnterpriseinfoDTO">
        update enterpriseinfo
        set logoImage       = #{logoimage,jdbcType=VARCHAR},
            eName           = #{ename,jdbcType=VARCHAR},
            ePlace          = #{eplace,jdbcType=VARCHAR},
            signLanguage    = #{signlanguage,jdbcType=VARCHAR},
            eIntroducation  = #{eintroducation,jdbcType=VARCHAR},
            financingStage  = #{financingstage,jdbcType=VARCHAR},
            category        = #{category,jdbcType=VARCHAR},
            eUrl            = #{eurl,jdbcType=VARCHAR},
            eImage1         = #{eimage1,jdbcType=VARCHAR},
            eImage2         = #{eimage2,jdbcType=VARCHAR},
            eImage3         = #{eimage3,jdbcType=VARCHAR},
            evaluationNum   = #{evaluationnum,jdbcType=INTEGER},
            positionNum     = #{positionnum,jdbcType=INTEGER},
            dealRate        = #{dealrate,jdbcType=DOUBLE},
            benefit1        = #{benefit1,jdbcType=VARCHAR},
            benefit2        = #{benefit2,jdbcType=VARCHAR},
            benefit3        = #{benefit3,jdbcType=VARCHAR},
            benefit4        = #{benefit4,jdbcType=VARCHAR},
            benefit5        = #{benefit5,jdbcType=VARCHAR},
            visitNum        = #{visitnum,jdbcType=INTEGER},
            numberOfWorkers = #{numberofworkers,jdbcType=VARCHAR}
        where eId = #{eid,jdbcType=CHAR}
    </update>

    <select id="getCompanyListData" resultMap="BaseResultMap">
        select eId,
        eName,
        logoImage,
        category,
        financingStage,
        numberOfWorkers,
        signLanguage,
        eUrl
        from enterpriseinfo
        <where>
            <if test="title!= null and title!=''">
                or eName LIKE concat('%',#{title},'%')
            </if>
            <if test="category!= null and category!=''">
                or category LIKE concat('%',#{category},'%')
            </if>
            <if test="numberofworkers!= null and numberofworkers!=''">
                or numberOfWorkers LIKE concat('%',#{numberofworkers},'%')
            </if>
            <if test="place!= null and place!=''">
                or ePlace LIKE concat('%',#{place},'%')
            </if>
            <if test="financingstage!= null and financingstage!=''">
                or financingStage LIKE concat('%',#{financingstage},'%')
            </if>
        </where>
    </select>

    <select id="selectALL" resultMap="BaseResultMap">
        select * from enterpriseinfo
    </select>
</mapper>